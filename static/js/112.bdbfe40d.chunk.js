"use strict";(self.webpackChunkhk_independent_bus_eta=self.webpackChunkhk_independent_bus_eta||[]).push([[112],{9167:function(e,t,n){n.r(t),n.d(t,{default:function(){return ze}});var o,a=n(1413),r=n(7313),i=n(7912),c=(n(3331),n(7458)),s=n(4778),l=n(6159),u=n(9466),d=n(7890),p=n(6173),g=n(2575),f=n(8866),m=n(178),h=n(2481),x=n(7829),b=n(4942),Z=n(9237),v=n(9856),j=n(5919),_=n(7983),y=n(180),w=n(4737),S=n(2495),k=n(4511),C=n(7592),T=n(5823),N=n(6417),W=function(){var e=(0,k.$)(),t=e.t,n=e.i18n,o=(0,d.TH)(),a=(0,r.useContext)(f.Z),i=a.selectedRoute,c=a.colorMode,s=a.vibrateDuration,l=(0,d.s0)(),p=function(e,t){t.preventDefault(),(0,T.tp)(s),setTimeout((function(){return l(e)}),0)};return(0,r.useMemo)((function(){return(0,N.jsxs)(A,{value:o.pathname.replace(/(.*)\/[0-9]*?$/,"$1"),showLabels:!0,classes:{root:R.root},children:[(0,N.jsx)(Z.Z,{label:t("\u9996\u9801"),component:u.rU,to:"/".concat(n.language),onClick:function(e){return p("/".concat(n.language),e)},value:"/".concat(n.language),icon:(0,N.jsx)(j.Z,{}),classes:{root:"footer-actionItem",selected:"footer-selected"}}),(0,N.jsx)(Z.Z,{label:t("\u641c\u5c0b"),component:u.rU,to:"/".concat(n.language,"/board"),onClick:function(e){return p("/".concat(n.language,"/board"),e)},value:"/".concat(n.language,"/board"),icon:(0,N.jsx)(_.Z,{}),classes:{root:"footer-actionItem",selected:"footer-selected"}}),(0,N.jsx)(Z.Z,{label:i.split("-")[0],component:u.rU,to:"/".concat(n.language,"/route/").concat(i.replace(/(.*)\/.*$/,"$1").toLowerCase()),onClick:function(e){return p("/".concat(n.language,"/route/").concat(i.toLowerCase()),e)},value:"/".concat(n.language,"/route/").concat(i.replace(/(.*)\/.*$/,"$1").toLowerCase()),icon:(0,N.jsx)(w.Z,{}),style:{textTransform:"uppercase"},classes:{root:"footer-actionItem",selected:"footer-selected"}}),(0,N.jsx)(Z.Z,{label:t("\u898f\u5283"),component:u.rU,to:"/".concat(n.language,"/search"),onClick:function(e){return p("/".concat(n.language,"/search"),e)},value:"/".concat(n.language,"/search"),icon:(0,N.jsx)(y.Z,{}),classes:{root:"footer-actionItem",selected:"footer-selected"}}),(0,N.jsx)(Z.Z,{label:t("\u8a2d\u5b9a"),component:u.rU,to:"/".concat(n.language,"/settings"),rel:"nofollow",onClick:function(e){return p("/".concat(n.language,"/settings"),e)},value:"/".concat(n.language,"/settings"),icon:(0,N.jsx)(S.Z,{}),classes:{root:"footer-actionItem",selected:R.selected}})]})}),[o.pathname,n.language,c,i,s])},I="footer",R={root:"".concat(I,"-root"),selected:"".concat(I,"-selected")},A=(0,C.ZP)(v.Z)((function(e){var t,n=e.theme;return(0,b.Z)({},"&.".concat(R.root),(t={background:"dark"===n.palette.mode?n.palette.background.default:n.palette.primary.main,bottom:"0",height:"initial"},(0,b.Z)(t,"& .MuiBottomNavigationAction-root",{width:"20%",padding:"6px 0",minWidth:0}),(0,b.Z)(t,"& .MuiBottomNavigationAction-label",{fontSize:"0.875rem"}),(0,b.Z)(t,"& .Mui-selected.".concat(R.selected),{color:"dark"===n.palette.mode?n.palette.primary.main:n.palette.text.primary}),t))})),P=n(1113),D=n(2461),L=n(8119),E=n(7131),H=n(9099),M=n(9289),O=n(647),F=n(9439),$=function(){var e=(0,r.useState)({}),t=(0,F.Z)(e,2),n=t[0],o=t[1];return(0,r.useEffect)((function(){var e=!0,t=function(){return"prerendering"===navigator.userAgent?(o({}),new Promise((function(e){return e([])}))):fetch("https://data.weather.gov.hk/weatherAPI/opendata/weather.php?dataType=warnsum&lang=en").then((function(e){return e.json()})).then((function(t){e&&o(t)}))},n=setInterval((function(){t()}),3e5);return t(),function(){e=!1,clearInterval(n)}}),[o]),n},z=["TC10","TC9","TC8SW","TC8NW","TC8SE","TC8NE","WRAINB","WRAINR","TC3","TC1","WRAINA","WL","WTS","WFNTSA","WHOT","WCOLD","WMSGNL"],G={TC10:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/No._10_Hurricane_Signal.png/30px-No._10_Hurricane_Signal.png",TC9:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7a/No._09_Increasing_Gale_or_Storm_Signal.png/30px-No._09_Increasing_Gale_or_Storm_Signal.png",TC8SW:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/No._8_Southwest_Gale_or_Storm_Signal.png/30px-No._8_Southwest_Gale_or_Storm_Signal.png",TC8NW:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/No._8_Northwest_Gale_or_Storm_Signal.png/30px-No._8_Northwest_Gale_or_Storm_Signal.png",TC8SE:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/No._8_Southeast_Gale_or_Storm_Signal.png/30px-No._8_Southeast_Gale_or_Storm_Signal.png",TC8NE:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/No._8_Northeast_Gale_or_Storm_Signal.png/30px-No._8_Northeast_Gale_or_Storm_Signal.png",WRAINB:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c0/Black_Rainstorm_Signal.png/25px-Black_Rainstorm_Signal.png",WRAINR:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Red_Rainstorm_Signal.png/25px-Red_Rainstorm_Signal.png",TC3:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/No._03_Strong_Wind_Signal.png/30px-No._03_Strong_Wind_Signal.png",TC1:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/No._01_Standby_Signal.png/30px-No._01_Standby_Signal.png",WRAINA:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/83/Amber_Rainstorm_Signal.png/25px-Amber_Rainstorm_Signal.png",WL:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5b/Landslip.gif/25px-Landslip.gif",WTS:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Thunderstorm_Warning.png/25px-Thunderstorm_Warning.png",WFNTSA:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Ntfl.gif/25px-Ntfl.gif",WHOT:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2e/Very_Hot_Weather_Warning.png/25px-Very_Hot_Weather_Warning.png",WCOLD:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Cold_Weather_Warning.png/25px-Cold_Weather_Warning.png",WMSGNL:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/HK_Monsoon_Signal.png/25px-HK_Monsoon_Signal.png"},B=function(){var e=(0,r.useContext)(f.Z),t=e.searchRoute,n=e.setSearchRoute,o=e.db.routeList,a=e.colorMode,i=e.vibrateDuration,c=e.geoPermission,s=e.updateGeolocation,l=e.changeLanguage,p=(0,k.$)(),g=p.t,m=p.i18n,h=(0,d.TH)(),b=(0,d.s0)(),Z=function(){var e=$();return Object.values(e).map((function(e){return e.code})).filter((function(e){return z.indexOf(e)>=0})).sort((function(e,t){return z.indexOf(e)<z.indexOf(t)?-1:1}))}(),v=(0,r.useCallback)((function(){try{navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,o=t.longitude;s({lat:n,lng:o})}))}catch(e){console.log("error in getting location")}}),[s]),j=(0,r.useCallback)((function(e){var o=e.key,a=e.ctrlKey,r=e.altKey,i=e.metaKey,c=e.target;a||r||i||"INPUT"!==c.tagName.toUpperCase()&&"TEXTAREA"!==c.tagName.toUpperCase()&&("Escape"===o?n(""):"Backspace"===o?n(t.slice(0,-1)):1===o.length&&(n(t+o),b("/".concat(m.language,"/board"),{replace:!0})))}),[t,m.language,n]);return(0,r.useEffect)((function(){return window.addEventListener("keydown",j),function(){window.removeEventListener("keydown",j)}}),[j]),(0,r.useMemo)((function(){return(0,N.jsxs)(K,{className:q.toolbar,children:[(0,N.jsx)(u.rU,{to:"/".concat(m.language,"/board"),onClick:function(e){e.preventDefault(),(0,T.tp)(i),b("/".concat(m.language,"/board"))},rel:"nofollow",children:(0,N.jsx)(P.Z,{component:"h1",variant:"subtitle2",className:q.appTitle,children:g("\u5df4\u58eb\u5230\u7ad9\u9810\u5831")})}),(0,N.jsx)(D.Z,{id:"searchInput",className:q.searchRouteInput,type:"text",value:t,placeholder:g("\u5df4\u58eb\u7dda"),onChange:function(e){(e.target.value.toUpperCase()in o||e.target.value in o)&&(document.activeElement.blur(),b("/".concat(m.language,"/route/").concat(e.target.value))),n(e.target.value)},onFocus:function(){(0,T.tp)(i),"prerendering"!==navigator.userAgent&&(0,T.z4)()&&document.activeElement.blur(),b("/".concat(m.language,"/board"),{replace:!0})}}),(0,N.jsxs)(x.Z,{className:q.funcPanel,children:[Z.slice(0,2).map((function(e){return(0,N.jsx)(L.Z,{onClick:function(){return window.open("https://www.hko.gov.hk/".concat("zh"===m.language?"tc":"en","/detail.htm"))},variant:"square",src:G[e],sx:{height:24,width:24,m:1}},e)})),"granted"===c&&(0,N.jsx)(E.Z,{"aria-label":"relocate",onClick:function(){return v()},children:(0,N.jsx)(O.Z,{})}),(0,N.jsx)(H.Z,{sx:V,onClick:function(){return e="zh"===m.language?"en":"zh",(0,T.tp)(i),b(h.pathname.replace("/"+m.language,"/"+e),{replace:!0}),void l(e);var e},id:"lang-selector",variant:"text",disableElevation:!0,disableRipple:!0,children:"zh"!==m.language?"\u7e41":"En"}),(0,N.jsx)(E.Z,{component:u.rU,to:"/".concat(m.language,"/settings"),rel:"nofollow",children:(0,N.jsx)(S.Z,{fontSize:"small"})})]})]})}),[t,m.language,h.pathname,a,c,i,Z])},U="header",q={toolbar:"".concat(U,"-toolbar"),appTitle:"".concat(U,"-appTitle"),searchRouteInput:"".concat(U,"-searchRouteInput"),funcPanel:"".concat(U,"-funcPanel")},K=(0,C.ZP)(M.Z)((function(e){var t,n=e.theme;return t={},(0,b.Z)(t,"& .".concat(q.appTitle),{color:"dark"===n.palette.mode?n.palette.primary.main:n.palette.text.primary}),(0,b.Z)(t,"&.".concat(q.toolbar),{backgroundColor:"dark"===n.palette.mode?n.palette.background.default:n.palette.primary.main,"& a":{textDecoration:"none"},display:"flex",justifyContent:"space-between",paddingLeft:n.spacing(1),paddingRight:n.spacing(1)}),(0,b.Z)(t,"& .".concat(q.searchRouteInput),{maxWidth:"100px","& input":{textAlign:"center"},"& input::before":{borderBottom:"1px ".concat(n.palette.text.primary," solid")}}),(0,b.Z)(t,"& .".concat(q.funcPanel),{display:"flex",alignItems:"center"}),t})),V={color:function(e){return e.palette.text.primary},minWidth:"40px",p:1,borderRadius:5,fontWeight:900,textTransform:"none"},J={display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"},Q={display:"flex",flexDirection:"column",flex:1,overflow:"hidden",backgroundColor:function(e){return e.palette.background.default}},X=function(){return(0,N.jsxs)(m.Z,{maxWidth:"xs",disableGutters:!0,sx:J,children:[(0,N.jsx)(h.ZP,{}),(0,N.jsx)(B,{}),(0,N.jsx)(x.Z,{sx:Q,children:(0,N.jsx)(d.j3,{})}),(0,N.jsx)(W,{})]})},Y=n(2295),ee=n(282),te=n(936),ne=n.n(te),oe=n(8485),ae=n(5280),re=n(9622),ie=n(6584),ce=n(5943),se=function(e){var t=e.homeTab,n=e.onChangeTab,o=(0,k.$)().t;return(0,N.jsxs)(oe.Z,{value:t,onChange:function(e,t){return n(t,!0)},sx:le,children:[(0,N.jsx)(ae.Z,{iconPosition:"start",icon:(0,N.jsx)(re.Z,{}),label:o("\u7d9c\u5408"),value:"both",disableRipple:!0}),(0,N.jsx)(ae.Z,{iconPosition:"start",icon:(0,N.jsx)(ie.Z,{}),label:o("\u5e38\u7528"),value:"saved",disableRipple:!0}),(0,N.jsx)(ae.Z,{iconPosition:"start",icon:(0,N.jsx)(ce.Z,{}),label:o("\u9644\u8fd1"),value:"nearby",disableRipple:!0})]})},le=(o={background:function(e){return e.palette.background.default},minHeight:"36px"},(0,b.Z)(o,"& .MuiTab-root",(0,b.Z)({alignItems:"center",justifyContent:"center",paddingTop:0,paddingBottom:0,minHeight:"32px"},"&.Mui-selected",{color:function(e){return"dark"===e.palette.mode?e.palette.primary.main:"black"}})),(0,b.Z)(o,"& .MuiTabs-flexContainer",{justifyContent:"center"}),(0,b.Z)(o,"& .MuiTabs-indicator",{backgroundColor:function(e){return"dark"===e.palette.mode?e.palette.primary.main:"black"}}),o),ue=n(4183),de=n(3405),pe=n(3428),ge=function(){var e=(0,k.$)().t,t=$();return"prerendering"!==navigator.userAgent&&t&&(t.WTCSGNL&&fe.includes(t.WTCSGNL.code)||t.WRAIN&&me.includes(t.WRAIN.code))?(0,N.jsx)(xe,{variant:"outlined",className:he.card,children:(0,N.jsx)(ue.Z,{href:e("bad-weather-link"),target:"_blank",children:(0,N.jsx)(de.Z,{children:(0,N.jsx)(P.Z,{children:e("bad-weather-text")})})})}):null},fe=["TC8NE","TC8SE","TC8NW","TC8SW","TC9","TC10"],me=["WARINR","WRAINB"],he={card:"".concat("route","-card")},xe=(0,C.ZP)(pe.Z)((function(e){var t=e.theme;return(0,b.Z)({},"&.".concat(he.card),(0,b.Z)({borderRadius:t.shape.borderRadius,margin:.2,height:"100%"},"> a",{height:"100%"}))})),be=n(3433),Ze=n(2547),ve=n(8310),je=n(3135),_e=n(1660),ye=n(421),we=r.forwardRef((function(e,t){var n=e.geolocation,o=e.homeTab,a=e.onChangeTab,i=(0,r.useContext)(f.Z),c=i.hotRoute,s=i.savedEtas,l=i.db,u=l.holidays,d=l.routeList,p=l.stopList,g=i.isRouteFilter,m=(0,r.useMemo)((function(){return(0,je.HD)(u,new Date)}),[u]),h=(0,r.useRef)(o),x=(0,k.$)().t,b=(0,r.useState)(null),Z=(0,F.Z)(b,2),v=Z[0],j=Z[1];(0,r.useImperativeHandle)(t,(function(){return{changeTab:function(e){h.current=e}}})),(0,r.useEffect)((function(){j(ke({geolocation:n,hotRoute:c,savedEtas:s,routeList:d,stopList:p,isRouteFilter:g,isTodayHoliday:m}))}),[n]);var _=(0,r.useMemo)((function(){return v?(0,N.jsx)(ve.Z,{disablePadding:!0,children:v.both.split("|").map((function(e,t){return Boolean(e)&&(0,N.jsx)(_e.Z,{routeId:e},"route-shortcut-".concat(t))}))}):(0,N.jsx)(ye.D,{sx:{my:10}})}),[v]),y=(0,r.useMemo)((function(){if(null===v)return(0,N.jsx)(ye.D,{sx:{my:10}});var e=v.saved.split("|").every((function(e){return!e}));return(0,N.jsx)(r.Fragment,{children:e?(0,N.jsx)(P.Z,{sx:{marginTop:5},children:(0,N.jsx)("b",{children:x("\u672a\u6709\u6536\u85cf\u8def\u7dda")})}):(0,N.jsx)(ve.Z,{disablePadding:!0,children:v.saved.split("|").map((function(e,t){return Boolean(e)&&(0,N.jsx)(_e.Z,{routeId:e},"route-shortcut-".concat(t))}))})})}),[v,x]),w=(0,r.useMemo)((function(){return v?(0,N.jsx)(ve.Z,{disablePadding:!0,children:v.nearby.split("|").map((function(e,t){return Boolean(e)&&(0,N.jsx)(_e.Z,{routeId:e},"route-shortcut-".concat(t))}))}):(0,N.jsx)(ye.D,{sx:{my:10}})}),[v]);return(0,r.useMemo)((function(){return(0,N.jsxs)(Ze.ZP,{index:Se.indexOf(h.current),onChangeIndex:function(e){a(Se[e])},children:[_,y,w]})}),[a,_,y,w])})),Se=["both","saved","nearby"],ke=function(e){var t=e.hotRoute,n=e.savedEtas,o=e.geolocation,a=e.stopList,r=e.routeList,i=e.isRouteFilter,c=e.isTodayHoliday,s=n.concat(Object.entries(t).filter((function(e){var t=(0,F.Z)(e,2);t[0];return t[1]>5})).sort((function(e,t){return t[1]-e[1]})).map((function(e){return(0,F.Z)(e,1)[0]}))).filter((function(e,t,n){return n.indexOf(e)===t&&e.split("/")[0]in r})).map((function(e,t,n){var i=e.split("/"),c=(0,F.Z)(i,2),s=c[0],l=c[1],u=a[Object.values(r[s].stops).sort((function(e,t){return t.length-e.length}))[0][l]];return[e,(0,T.Sp)(o,u.location),n.length-t]})),l=Object.entries(a).map((function(e){return[].concat((0,be.Z)(e),[(0,T.Sp)(e[1].location,o)])})).filter((function(e){return e[2]<1e3})).sort((function(e,t){return e[2]-t[2]})).slice(0,20).reduce((function(e,t){var n=(0,F.Z)(t,1)[0],o=[];return Object.entries(r).forEach((function(e){var t=(0,F.Z)(e,2),a=t[0],r=t[1];["kmb","nwfb","ctb","nlb"].forEach((function(e){r.stops[e]&&r.stops[e].includes(n)&&o.push(a+"/"+r.stops[e].indexOf(n))}))})),e.concat(o)}),[]),u=function(e){return e.filter((function(e,t,n){return n.indexOf(e)===t})).filter((function(e){var t=e.split("/"),n=(0,F.Z)(t,1)[0];return!i||(0,je.x4)(n,r[n].freq,c)})).concat(Array(40).fill("")).slice(0,40).join("|")};return{saved:u(s.sort((function(e,t){return e[2]-t[2]})).map((function(e){return e[0]})).slice(0,40)),nearby:u(l),both:u([].concat(s.sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]})).slice(0,40)).concat(l))}},Ce=function(){var e,t=(0,r.useContext)(f.Z),n=t.AppTitle,o=t.geolocation,a=(0,k.$)(),i=a.t,c=a.i18n,s=(0,r.useRef)(null),l=localStorage.getItem("homeTab"),u=(0,r.useState)("both"===(e=l)||"saved"===e||"nearby"===e?l:"both"),d=(0,F.Z)(u,2),p=d[0],g=d[1];(0,r.useEffect)((function(){(0,T.ND)({title:"".concat(i("Dashboard")," - ").concat(i(n)),description:i("home-page-description"),lang:c.language})}),[c.language]);var m=(0,r.useState)(o),h=(0,F.Z)(m,2),x=h[0],b=h[1],Z=(0,r.useRef)(ne()((function(){b(o)}),1e3)).current;(0,r.useEffect)((function(){Z(o)}),[o]);var v=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];g(e),localStorage.setItem("homeTab",e),s.current&&t&&s.current.changeTab(e)};return(0,N.jsxs)(Y.Z,{sx:Te,square:!0,elevation:0,children:[(0,N.jsx)(P.Z,{component:"h1",style:ee.Z,children:"".concat(i("Dashboard")," - ").concat(i(n))}),(0,N.jsx)(P.Z,{component:"h2",style:ee.Z,children:i("home-page-description")}),(0,N.jsx)(se,{homeTab:p,onChangeTab:v}),(0,N.jsx)(ge,{}),(0,N.jsx)(we,{ref:s,homeTab:p,geolocation:x,onChangeTab:v})]})},Te={background:function(e){return"dark"===e.palette.mode?e.palette.background.default:"white"},textAlign:"center",display:"flex",flexDirection:"column",overflow:"auto",width:"100%"},Ne=n(5640),We=function(e){var t=e.name,n=e.delta,o=e.value,a=e.id;window.gtag?window.gtag("event",t,{value:n,metric_id:a,metric_value:o,metric_delta:n}):console.log("gtag not found")},Ie=function(e){e&&e instanceof Function&&n.e(27).then(n.bind(n,4027)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),o(e),a(e),r(e),i(e)}))},Re=n(2392),Ae=n(1204),Pe=n(2586),De=function(){var e=(0,k.$)().t,t=(0,r.useContext)(f.Z),n=t.savedEtas,o=t.setSavedEtas,a=(0,r.useState)(JSON.stringify(n,null,2)),i=(0,F.Z)(a,2),c=i[0],s=i[1],l=(0,r.useState)(!1),u=(0,F.Z)(l,2),d=u[0],p=u[1];return(0,N.jsxs)(x.Z,{sx:Le,children:[(0,N.jsx)(P.Z,{variant:"h6",sx:{textAlign:"center"},children:e("\u8cc7\u6599\u532f\u51fa\u532f\u5165")}),(0,N.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"column",m:1},children:[(0,N.jsx)(Re.Z,{multiline:!0,value:c,onChange:function(e){var t=e.target.value;s(t);try{var n=JSON.parse(t);Array.isArray(n)&&o(n.filter((function(e){return"string"===typeof e||e instanceof String})))}catch(a){}}}),(0,N.jsx)(x.Z,{sx:{m:1},children:(0,N.jsx)(E.Z,{onClick:function(){var e;null===(e=navigator.clipboard)||void 0===e||e.writeText(JSON.stringify(n,null,2)).then((function(){p(!0)}))},children:(0,N.jsx)(Pe.Z,{})})})]}),(0,N.jsx)(Ae.Z,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:d,autoHideDuration:1500,onClose:function(){p(!1)},message:e("\u5df2\u8907\u88fd\u5230\u526a\u8cbc\u7c3f")})]})},Le={justifyContent:"center",flex:1},Ee=(0,i.ZP)((function(){return Promise.all([n.e(418),n.e(303),n.e(457),n.e(577)]).then(n.bind(n,7577))})),He=(0,i.ZP)((function(){return Promise.all([n.e(840),n.e(21)]).then(n.bind(n,5021))})),Me=(0,i.ZP)((function(){return Promise.all([n.e(512),n.e(418),n.e(787),n.e(635)]).then(n.bind(n,1635))})),Oe=(0,i.ZP)((function(){return Promise.all([n.e(303),n.e(173),n.e(546)]).then(n.bind(n,546))})),Fe=(0,i.ZP)((function(){return n.e(370).then(n.bind(n,3370))})),$e=(0,i.ZP)((function(){return n.e(481).then(n.bind(n,7481))})),ze=function(){var e=(0,r.useContext)(f.Z),t=e.colorMode,n=e.analytics,o=(0,k.$)().i18n.language;n&&Ie(We);var a=(0,r.useMemo)((function(){return(0,c.Z)(Be(t),[t])}),[t]);return(0,N.jsx)(s.Z,{injectFirst:!0,children:(0,N.jsx)(l.Z,{theme:a,children:(0,N.jsx)(p.C,{value:Ge,children:(0,N.jsx)(u.VK,{children:(0,N.jsx)(Ne.N,{children:(0,N.jsxs)(d.Z5,{children:[(0,N.jsx)(d.AW,{path:"/",element:(0,N.jsx)(d.Fg,{to:"/".concat(o)})}),(0,N.jsxs)(d.AW,{path:"/:lang",element:(0,N.jsx)(X,{}),children:[(0,N.jsx)(d.AW,{path:"route/:id",element:(0,N.jsx)(Ee,{})}),(0,N.jsx)(d.AW,{path:"route/:id/:panel",element:(0,N.jsx)(Ee,{})}),(0,N.jsx)(d.AW,{path:"settings",element:(0,N.jsx)(Oe,{})}),(0,N.jsx)(d.AW,{path:"qr-code",element:(0,N.jsx)(De,{})}),(0,N.jsx)(d.AW,{path:"board",element:(0,N.jsx)(He,{})}),(0,N.jsx)(d.AW,{path:"search",element:(0,N.jsx)(Me,{})}),(0,N.jsx)(d.AW,{path:"privacy",element:(0,N.jsx)(Fe,{})}),(0,N.jsx)(d.AW,{path:"terms",element:(0,N.jsx)($e,{})}),(0,N.jsx)(d.AW,{path:"",element:(0,N.jsx)(Ce,{})})]})]})})})})})})},Ge=(0,g.Z)({key:"hkbus",speedy:!("prerendering"===navigator.userAgent)}),Be=function(e){return{typography:{fontFamily:"'Chiron Sans HK Pro WS', sans-serif"},palette:(0,a.Z)({mode:e},"light"===e?{background:{default:"#fedb00"},primary:{main:"#fedb00",contrastText:"rgba(0, 0, 0, 0.12)"}}:{background:{default:"#000",contrast:"rgba(255, 255, 255, 0.12)"},primary:{main:"#fedb00"}}),elements:{MuiCssBaseline:{styleOverrides:{html:{userSelect:"none"},body:{fontSize:"0.875rem",lineHeight:1.43,scrollbarColor:"#3f3f3f",scrollbarWidth:"thin"}}}}}}},5640:function(e,t,n){n.d(t,{N:function(){return c}});var o=n(9439),a=n(7313),r=n(6417),i=a.createContext({}),c=function(e){var t=(0,a.useState)({start:null,end:null}),n=(0,o.Z)(t,2),c=n[0],s=n[1],l=(0,a.useState)("ready"),u=(0,o.Z)(l,2),d=u[0],p=u[1],g=(0,a.useState)([]),f=(0,o.Z)(g,2),m=f[0],h=f[1],x=(0,a.useState)({resultIdx:0,stopIdx:[0,0]}),b=(0,o.Z)(x,2),Z=b[0],v=b[1];return(0,r.jsx)(i.Provider,{value:{locations:c,setLocations:s,status:d,setStatus:p,result:m,setResult:h,resultIdx:Z,setResultIdx:v},children:e.children})};t.Z=i},9878:function(e,t,n){n.d(t,{e:function(){return l}});var o=n(1413),a=n(9439),r=n(7313),i=n(4511),c=n(7420),s=n(8866),l=function(e){var t=(0,r.useContext)(s.Z),n=t.db.routeList,l=t.isVisible,d=e.split("/"),p=(0,a.Z)(d,2),g=p[0],f=p[1],m=n[g]||u,h=(0,r.useState)(null),x=(0,a.Z)(h,2),b=x[0],Z=x[1],v=(0,i.$)().i18n.language;return(0,r.useEffect)((function(){var e=!0,t=function(){return l&&"prerendering"!==navigator.userAgent?(0,c.fetchEtas)((0,o.Z)((0,o.Z)({},m),{},{seq:parseInt(f,10),language:v})).then((function(t){e&&Z(t)})):(Z(null),new Promise((function(e){return e([])})))},n=setInterval((function(){t()}),3e4);return t(),function(){e=!1,clearInterval(n)}}),[e,l]),b},u={co:[""],stops:{"":[""]},dest:{zh:"",en:""},bound:"",nlbId:0,gtfsId:"",fares:[],faresHoliday:[]}},421:function(e,t,n){n.d(t,{D:function(){return p},u:function(){return d}});var o=n(1413),a=n(5987),r=n(7313),i=n(9176),c=n(5281),s=n(6417),l=["sx","color"],u=["sx","color"],d=r.forwardRef((function(e,t){var n=e.sx,r=e.color,c=(0,a.Z)(e,l);return(0,s.jsx)(i.Z,(0,o.Z)({color:null!==r&&void 0!==r?r:"inherit",sx:(0,o.Z)({m:1,height:5,borderRadius:5},n),ref:t},c))})),p=r.forwardRef((function(e,t){var n=e.sx,r=e.color,i=(0,a.Z)(e,u);return(0,s.jsx)(c.Z,(0,o.Z)({color:null!==r&&void 0!==r?r:"inherit",sx:(0,o.Z)({m:1},n),ref:t},i))}))},1660:function(e,t,n){n.d(t,{Z:function(){return T}});var o=n(4942),a=n(9439),r=n(7313),i=n(9282),c=n(1113),s=n(7829),l=n(4313),u=n(7216),d=n(6480),p=n(9466),g=n(7890),f=n(5823),m=n(7592),h=n(8866),x=n(4511),b=n(9878),Z=n(6417),v=function(e){var t=e.routeId,n=(0,x.$)(),o=n.t,a=n.i18n,i=(0,r.useContext)(h.Z).etaFormat,s=(0,b.e)(t),l=function(e){if(!e||!e.eta)return"";var t=Math.round((new Date(e.eta).getTime()-(new Date).getTime())/60/1e3);if(!Number.isInteger(t))return e.remark[a.language];var n=e.eta.slice(11,16),r=t<1?"- ".concat(o("\u5206\u9418")):"".concat(t," ").concat(o("\u5206\u9418"));switch(i){case"exact":return n;case"diff":return r;default:return"".concat(n," (").concat(r,")")}};return(0,Z.jsx)(y,{primary:(0,Z.jsx)(c.Z,{component:"h5",color:"textPrimary",sx:{whiteSpace:"nowrap"},children:s?l(s[0]):""}),secondary:(0,Z.jsxs)(c.Z,{variant:"h6",color:"textSecondary",className:_.secondary,children:[s?l(s[1]):"",(0,Z.jsx)("br",{}),s?l(s[2]):""]}),className:_.root})},j="etas",_={root:"".concat(j,"-root"),secondary:"".concat(j,"-secondary")},y=(0,m.ZP)(i.Z)((function(e){var t;e.theme;return t={},(0,o.Z)(t,"&.".concat(_.root),{textAlign:"right"}),(0,o.Z)(t,"& .".concat(_.secondary),{fontSize:"0.875rem",fontWeight:"400",lineHeight:"1.43",whiteSpace:"nowrap",textAlign:"right"}),t})),w=n(9530),S=function(e){var t=e.name,n=e.location,o=e.fares,a=e.faresHoliday,i=e.seq,c=(0,x.$)().t,s=(0,r.useContext)(h.Z),l=s.geoPermission,u=s.geolocation,d=[o&&o[i]?"$"+o[i]:"",a&&a[i]?"$"+a[i]:""].filter((function(e){return e})).join(", "),p=(0,f.Qi)(n,u),g=p.distance,m=p.unit,b=p.decimalPlace;return"granted"!==l||0===n.lat?(0,Z.jsx)(Z.Fragment,{children:t+"\u3000"+(d?"("+d+")":"")}):(0,Z.jsx)(Z.Fragment,{children:t+" - "+g.toFixed(b)+c(m)+"\u3000"+(d?"("+d+")":"")})},k={co:[""],stops:{"":[""]},dest:{zh:"",en:""},bound:"",nlbId:0,fares:[],faresHoliday:[]},C={location:{lat:0,lng:0},name:{zh:"",en:""}},T=function(e){var t=e.routeId,n=e.disabled,o=void 0!==n&&n,u=(0,x.$)(),m=u.t,b=u.i18n,j=(0,r.useContext)(h.Z),_=j.db,y=_.routeList,T=_.stopList,W=j.vibrateDuration,P=t.split("-"),D=(0,a.Z)(P,1)[0],L=t.split("/"),E=(0,a.Z)(L,2),H=E[0],M=E[1],O=y[H]||k,F=O.co,$=O.stops,z=O.dest,G=O.fares,B=O.faresHoliday,U=T[N(F,$)[parseInt(M,10)]]||C,q=(0,g.s0)();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(R,{component:o?void 0:p.rU,to:"/".concat(b.language,"/route/").concat(H.toLowerCase()),onClick:o?function(){}:function(e){e.preventDefault(),(0,f.tp)(W),setTimeout((function(){q("/".concat(b.language,"/route/").concat(t.toLowerCase()))}),0)},className:I.listItem,children:[(0,Z.jsx)(i.Z,{primary:(0,Z.jsx)(w.Z,{routeNo:D})}),(0,Z.jsx)(i.Z,{primary:(0,Z.jsxs)(c.Z,{component:"h3",variant:"body1",color:"textPrimary",className:I.fromToWrapper,children:[(0,Z.jsx)("span",{className:I.fromToText,children:m("\u5f80")}),(0,Z.jsx)("b",{children:(0,f.iF)(z[b.language])})]}),secondary:(0,Z.jsx)(S,{name:(0,f.iF)(U.name[b.language]),location:U.location,fares:G,faresHoliday:B,seq:parseInt(M,10)}),secondaryTypographyProps:{component:"h4",variant:"subtitle2"},className:I.routeDest}),o?(0,Z.jsx)(s.Z,{sx:A,children:(0,Z.jsx)(d.Z,{})}):(0,Z.jsx)(v,{routeId:t})]}),(0,Z.jsx)(l.Z,{})]})},N=function(e,t){for(var n=0;n<e.length;++n)if(e[n]in t)return t[e[n]]},W="succinctTimeReport",I={listItem:"".concat(W,"-listItem"),route:"".concat(W,"-route"),routeDest:"".concat(W,"-routeDest"),fromToWrapper:"".concat(W,"-fromToWrapper"),fromToText:"".concat(W,"-fromToText")},R=(0,m.ZP)(u.ZP)((function(e){var t,n=e.theme;return t={display:"grid",gridTemplateColumns:"15% 1fr minmax(18%, max-content)"},(0,o.Z)(t,"&.".concat(I.listItem),{padding:"4px 8px",color:"rgba(0,0,0,0.87)"}),(0,o.Z)(t,"& .".concat(I.routeDest),{overflow:"hidden"}),(0,o.Z)(t,"& .".concat(I.fromToWrapper),{display:"flex",alignItems:"baseline",fontSize:"1.2rem"}),(0,o.Z)(t,"& .".concat(I.fromToText),{fontSize:"0.85rem",marginRight:n.spacing(.5)}),t})),A={color:function(e){return e.palette.text.primary},flex:1,display:"flex",alignItems:"center",justifyContent:"center"}},9530:function(e,t,n){var o=n(4942),a=n(9439),r=(n(7313),n(1113)),i=n(7592),c=n(6417);t.Z=function(e){var t=e.routeNo,n=e.component,o=e.align,r=t.match(/[0-9][A-Z]+$/)?[t.slice(0,-1),t.slice(-1)]:[t,""],i=(0,a.Z)(r,2),s=i[0],d=i[1];return(0,c.jsxs)(u,{component:n||"h2",align:o,variant:"caption",color:"textPrimary",className:l.root,children:[(0,c.jsx)("span",{className:l.prefix,children:s}),(0,c.jsx)("span",{className:l.suffix,children:d})]})};var s="routeNo",l={root:"".concat(s,"-root"),prefix:"".concat(s,"-prefix"),suffix:"".concat(s,"-suffix")},u=(0,i.ZP)(r.Z)((function(e){var t;e.theme;return t={},(0,o.Z)(t,"&.".concat(l.root),{lineHeight:"normal",display:"inline"}),(0,o.Z)(t,"& .".concat(l.prefix),{fontSize:"1.5rem",fontFamily:'"Oswald", sans-serif'}),(0,o.Z)(t,"& .".concat(l.suffix),{fontSize:"1.2rem",fontFamily:'"Oswald", sans-serif'}),t}))},3135:function(e,t,n){n.d(t,{HD:function(){return i},x4:function(){return c}});var o=n(9439),a={266:[0,0,1,1,1,0,0],271:[0,1,1,1,1,0,0],272:[0,0,0,0,0,1,0],287:[0,1,1,1,1,1,0],288:[0,0,0,0,0,0,1],319:[0,1,1,1,1,1,1],320:[1,0,0,0,0,0,0],415:[0,1,1,1,1,1,0],416:[1,0,0,0,0,0,1],447:[0,1,1,1,1,1,1],448:[1,0,0,0,0,0,0],480:[1,0,0,0,0,0,1],511:[1,1,1,1,1,1,1],31:[0,1,1,1,1,1,0],63:[0,1,1,1,1,1,1],111:[1,1,0,1,1,1,1]},r=function(e,t){var n=24*e*60;return n+=60*parseInt(t.slice(0,2),10)+parseInt(t.slice(2),10)},i=function(e,t){return e.includes("".concat(t.getFullYear()).concat(("0"+(t.getMonth()+1)).slice(-2)).concat(("0"+t.getDate()).slice(-2)))},c=function(e,t,n){if(!t)return!0;var i=!1,c=new Date,s=r(n?0:c.getDay(),("0"+c.getHours()).slice(-2)+("0"+c.getMinutes()).slice(-2));return Object.entries(t).forEach((function(t){var n=(0,o.Z)(t,2),c=n[0],l=n[1];try{a[c].forEach((function(e,t){e&&Object.entries(l).forEach((function(e){var n,a,c,l=(0,o.Z)(e,2),u=l[0],d=l[1],p=r(t,u),g=r(t,d?d[0]:u);i=i||(a=g,(n=p)-60<=(c=s)&&c<=a+60||n-60<=c+10080&&c+10080<=a+60)}))}))}catch(u){console.log(e+" has unknown service ID")}})),i}}}]);